{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/dknipe/Documents/projects/david-tec-frontend/app/api/blog/%5Byear%5D/%5Bmonth%5D/%5Bslug%5D/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport type { BlogPost } from '@/lib/api'\n\nexport async function GET(\n  request: Request,\n  { params }: { params: Promise<{ year: string; month: string; slug: string }> }\n) {\n  const { year, month, slug } = await params\n\n  const baseUrl = 'https://david-tec-api-proxy.david-tec.workers.dev/search/content/'\n  const filterParams = new URLSearchParams({\n    filter: \"ContentType/any(t:t eq 'BlogPostPage')\",\n    orderby: 'StartPublish desc',\n    personalize: 'true',\n  })\n\n  try {\n    // Fetch all posts (this will be cached by Next.js)\n    const response = await fetch(`${baseUrl}?${filterParams.toString()}&skip=0&top=100`, {\n      next: { revalidate: 3600 }, // Cache for 1 hour\n    })\n\n    if (!response.ok) {\n      return NextResponse.json(\n        { error: `API request failed: ${response.status}` },\n        { status: response.status }\n      )\n    }\n\n    const data = await response.json()\n    const posts: BlogPost[] = data.Results\n\n    // Try to find the post with flexible URL matching\n    const urlPath1 = `/${year}/${month}/${slug}/`\n    const urlPath2 = `/${year}/${month}/${slug}`\n\n    const post = posts.find(p => {\n      const normalizedUrl = p.Url.toLowerCase().replace(/\\/$/, '')\n      const normalizedPath1 = urlPath1.toLowerCase().replace(/\\/$/, '')\n      const normalizedPath2 = urlPath2.toLowerCase().replace(/\\/$/, '')\n      return normalizedUrl === normalizedPath1 || normalizedUrl === normalizedPath2\n    })\n\n    if (!post) {\n      return NextResponse.json(\n        { error: 'Post not found' },\n        { status: 404 }\n      )\n    }\n\n    return NextResponse.json(post)\n  } catch (error) {\n    console.error('Error fetching blog post:', error)\n    return NextResponse.json(\n      { error: 'Failed to fetch blog post' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAGO,eAAe,IACpB,OAAgB,EAChB,EAAE,MAAM,EAAsE;IAE9E,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,MAAM;IAEpC,MAAM,UAAU;IAChB,MAAM,eAAe,IAAI,gBAAgB;QACvC,QAAQ;QACR,SAAS;QACT,aAAa;IACf;IAEA,IAAI;QACF,mDAAmD;QACnD,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,CAAC,EAAE,aAAa,QAAQ,GAAG,eAAe,CAAC,EAAE;YACnF,MAAM;gBAAE,YAAY;YAAK;QAC3B;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,CAAC,oBAAoB,EAAE,SAAS,MAAM,EAAE;YAAC,GAClD;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAE9B;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,QAAoB,KAAK,OAAO;QAEtC,kDAAkD;QAClD,MAAM,WAAW,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,KAAK,CAAC,CAAC;QAC7C,MAAM,WAAW,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,MAAM;QAE5C,MAAM,OAAO,MAAM,IAAI,CAAC,CAAA;YACtB,MAAM,gBAAgB,EAAE,GAAG,CAAC,WAAW,GAAG,OAAO,CAAC,OAAO;YACzD,MAAM,kBAAkB,SAAS,WAAW,GAAG,OAAO,CAAC,OAAO;YAC9D,MAAM,kBAAkB,SAAS,WAAW,GAAG,OAAO,CAAC,OAAO;YAC9D,OAAO,kBAAkB,mBAAmB,kBAAkB;QAChE;QAEA,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAiB,GAC1B;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA4B,GACrC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}