{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/dknipe/Documents/projects/david-tec-frontend/app/api/blog/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport type { BlogPost, ApiResponse } from '@/lib/api'\n\nexport async function GET() {\n  const baseUrl = 'https://david-tec-api-proxy.david-tec.workers.dev/search/content/'\n  const params = new URLSearchParams({\n    filter: \"ContentType/any(t:t eq 'BlogPostPage')\",\n    orderby: 'StartPublish desc',\n    personalize: 'true',\n  })\n\n  let allPosts: BlogPost[] = []\n  let skip = 0\n  const top = 100\n  let totalMatching = 0\n\n  try {\n    // First request to get total count\n    const firstUrl = `${baseUrl}?${params.toString()}&skip=${skip}&top=${top}`\n    const firstResponse = await fetch(firstUrl, {\n      next: { revalidate: 3600 }, // Cache for 1 hour\n    })\n\n    if (!firstResponse.ok) {\n      return NextResponse.json(\n        { error: `API request failed: ${firstResponse.status}` },\n        { status: firstResponse.status }\n      )\n    }\n\n    const firstData: ApiResponse = await firstResponse.json()\n    totalMatching = firstData.TotalMatching\n    allPosts = [...firstData.Results]\n\n    // Fetch remaining pages\n    while (allPosts.length < totalMatching) {\n      skip += top\n      const url = `${baseUrl}?${params.toString()}&skip=${skip}&top=${top}`\n      const response = await fetch(url, {\n        next: { revalidate: 3600 },\n      })\n\n      if (!response.ok) {\n        console.error(`Failed to fetch page at skip=${skip}`)\n        break\n      }\n\n      const data: ApiResponse = await response.json()\n      allPosts = [...allPosts, ...data.Results]\n    }\n\n    return NextResponse.json(allPosts)\n  } catch (error) {\n    console.error('Error fetching blog posts:', error)\n    return NextResponse.json(\n      { error: 'Failed to fetch blog posts' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAGO,eAAe;IACpB,MAAM,UAAU;IAChB,MAAM,SAAS,IAAI,gBAAgB;QACjC,QAAQ;QACR,SAAS;QACT,aAAa;IACf;IAEA,IAAI,WAAuB,EAAE;IAC7B,IAAI,OAAO;IACX,MAAM,MAAM;IACZ,IAAI,gBAAgB;IAEpB,IAAI;QACF,mCAAmC;QACnC,MAAM,WAAW,GAAG,QAAQ,CAAC,EAAE,OAAO,QAAQ,GAAG,MAAM,EAAE,KAAK,KAAK,EAAE,KAAK;QAC1E,MAAM,gBAAgB,MAAM,MAAM,UAAU;YAC1C,MAAM;gBAAE,YAAY;YAAK;QAC3B;QAEA,IAAI,CAAC,cAAc,EAAE,EAAE;YACrB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,CAAC,oBAAoB,EAAE,cAAc,MAAM,EAAE;YAAC,GACvD;gBAAE,QAAQ,cAAc,MAAM;YAAC;QAEnC;QAEA,MAAM,YAAyB,MAAM,cAAc,IAAI;QACvD,gBAAgB,UAAU,aAAa;QACvC,WAAW;eAAI,UAAU,OAAO;SAAC;QAEjC,wBAAwB;QACxB,MAAO,SAAS,MAAM,GAAG,cAAe;YACtC,QAAQ;YACR,MAAM,MAAM,GAAG,QAAQ,CAAC,EAAE,OAAO,QAAQ,GAAG,MAAM,EAAE,KAAK,KAAK,EAAE,KAAK;YACrE,MAAM,WAAW,MAAM,MAAM,KAAK;gBAChC,MAAM;oBAAE,YAAY;gBAAK;YAC3B;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,QAAQ,KAAK,CAAC,CAAC,6BAA6B,EAAE,MAAM;gBACpD;YACF;YAEA,MAAM,OAAoB,MAAM,SAAS,IAAI;YAC7C,WAAW;mBAAI;mBAAa,KAAK,OAAO;aAAC;QAC3C;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA6B,GACtC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}